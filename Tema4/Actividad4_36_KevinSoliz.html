<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>Actividad 4.36</h1>
  </body>
  <script>
    //Primero necesito una función para sacar números aleatorios, pero que no se repitan.
    function arraySinRepetidos(n) {
      let sinRepetidos = [];

      for (let i = 0; i < n; i++) {
        let aleatorio = Math.floor(Math.random() * 90) + 1;
        if(!sinRepetidos.includes(aleatorio)) { // Si el aleatorio no está dentro entonces lo incluimos en el array.
          sinRepetidos[i] = aleatorio;
        }
        else {
          i--; // Si el aleatorio ya ha salido antes, retrocedemos una iteración.
        }
      }
      return sinRepetidos;
    }

    //Segunda función que cree un cartón con 20 números en una tabla de 8x4, 12 van a ser 0.
    function crearCarton() {
      let carton = [];
      //Para inicializar el array bidimensional:
      for (let i = 0; i < 8; i++) {
        carton[i] = [];
      }

      //Los 20 números no pueden ser repetidos
      let k = 0;
      let sinRepetidos = arraySinRepetidos(20);

      //Array de ceros
      let arrayCeros = [];
      for (let i = 0; i < 12; i++) {
        arrayCeros[i] = 0;
      }
      //Mezclamos array de ceros con sinRepetidos:
      let combinacion = [...arrayCeros, ...sinRepetidos];
     desordenar(combinacion);

      for (let i = 0 ; i < 8; i++) {
        for (let j = 0; j < 4; j++) {
            carton[i][j] = combinacion[k];
            k++;
        }
      }

      return carton;
    }

    //Necesito esta función para desordenar el array combinado de los 12 ceros y los 20 números.
    function desordenar(array) {
        for ( let i = 0; i < array.length; i++) {
          let j = Math.floor(Math.random() * (array.length - i) + i);
          let copia = array[i];
          array[i] = array[j];
          array[j] = copia;
        }
    }

  // El siguiente paso es crear una función que compruebe si el número de la bola coincide o no con algún número de un cartón.
  //Si coincide lo marcamos

  function marcarCarton(carton, numBola) {

    for(let i = 0; i < carton.length; i++) {
      for(let j = 0; j < carton[i].length; j++){

        if(carton[i][j] === numBola) {
          carton[i][j] += 'X';

        }

      }
    }
   return contarMarcados(carton) === 20; // Este boleano servirá para gritar bingo.
  }

//Necesitaba una función que contase los marcados:
  function contarMarcados(carton) {
      let marcados = 0;
      for (let filas of carton) {
        for (let numero of filas) {
          if(typeof numero === 'string') {
            marcados++;
          }
        }
      }
      return marcados;
  }



  // El juego del bingo:

  let bolas = arraySinRepetidos(90);
  let bingo = false;

  let carton1 = crearCarton();
  let carton2 = crearCarton();
  let carton3 = crearCarton();
  let carton4 = crearCarton();
  let carton5 = crearCarton();

  let bolasSacadas = [];
  let contador = 0;
  let ganador = '';
  let cartonGanador = [];

 while (!bingo) {
   bolasSacadas[contador] = bolas[contador];
   if(marcarCarton(carton1, bolasSacadas[contador])) {
     bingo = true;
     ganador = 'Cartón 1';
     cartonGanador = carton1;
   }
   if(marcarCarton(carton2, bolasSacadas[contador])) {
     bingo = true;
     ganador = 'Cartón 2';
     cartonGanador = carton2;
   }

   if(marcarCarton(carton3, bolasSacadas[contador])) {
     bingo = true;
     ganador = 'Cartón 3';
     cartonGanador = carton3;
   }
   if(marcarCarton(carton4, bolasSacadas[contador])) {
     bingo = true;
     ganador = 'Cartón 4';
     cartonGanador = carton4;
   }
   if(marcarCarton(carton5, bolasSacadas[contador])) {
     bingo = true;
     ganador = 'Cartón 5';
     cartonGanador = carton5;
   }

   contador++
 }
 console.log('El ganador es: ' + ganador);
 console.log('Cartón: ');
 console.table(cartonGanador);
 console.log('Números que han salido de las ' + bolasSacadas.length + ' bolas.');
 console.log(bolasSacadas);


  </script>
</html  >
